<!doctype html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agence Web - Performance et Accessibilité</title>
    
    <!-- CSS minifié -->
    <link rel="stylesheet" href="css/style.min.css">
    
    <!-- Scripts JS minifiés et différés -->
    <script src="js/jquery-3.5.1.min.js" defer></script>
    <script src="js/client-service.min.js" defer></script>
</head>
<body>

<header role="banner">
    <h1>Bienvenue sur notre Agence Web</h1>
</header>

<main role="main">
    <section aria-labelledby="gestion-contacts">
        <h2 id="gestion-contacts">Gestion des Contacts</h2>
        <button id="run" aria-label="Exécuter les opérations de gestion des contacts">Exécuter les opérations CRUD</button>
        <div id="log" aria-live="polite"></div>
    </section>
</main>

<script>
$(document).ready(function () {
    $("#run").click(function () {
        
        function log(message, data) {
            $('#log').append("<hr/><b>" + message + "</b><pre>" + JSON.stringify(data, null, 2) + "</pre>");
        }

        ClientService.createContact({
            prenom: "Alice",
            nom: "Dupont",
            email: "alice.dupont@example.com"
        })
        .then(function (result) {
            log("Contact Créé :", result);
            return ClientService.readContact(result.id);
        })
        .then(function (result) {
            log("Contact Lu :", result);
            return ClientService.updateContact(result.id, {
                prenom: "Alice",
                nom: "Dupont",
                telephone: "0601020304"
            });
        })
        .then(function (result) {
            log("Contact Mis à Jour :", result);
            return ClientService.deletePhoneNumber(result.id, result.phoneNumbers[0].id);
        })
        .then(function (result) {
            log("Numéro de Téléphone Supprimé :", result);
            return ClientService.readContact(result.id);
        })
        .then(function (result) {
            log("Contact Après Suppression du Numéro :", result);
            return ClientService.deleteContact(result.id);
        })
        .then(function (result) {
            log("Contact Supprimé :", result);
        })
        .catch(function (error) {
            log("Erreur :", error);
        });
    });
});
</script>

</body>
</html>
